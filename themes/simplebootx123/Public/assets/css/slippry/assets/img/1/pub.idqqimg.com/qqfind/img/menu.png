<?php
/* vim: set expandtab sw=4 ts=4 sts=4: */
/**
 * Used to render the console of PMA's pages
 *
 * @package PhpMyAdmin
 */
namespace PMA\libraries;

if (! defined('PHPMYADMIN')) {
    exit;
}

require_once 'libraries/bookmark.lib.php';

/**
 * Class used to output the console
 *
 * @package PhpMyAdmin
 */
class Console
{
    /**
     * Whether to display anything
     *
     * @access private
     * @var bool
     */
    private $_isEnabled;

    /**
     * Creates a new class instance
     */
    public function __construct()
    {
        $this->_isEnabled = true;
    }

    /**
     * Whether we are servicing an ajax request.
     * We can't simply use $GLOBALS['is_ajax_request']
     * here since it may have not been initialised yet.
     *
     * @access private
     * @var bool
     */
    private $_isAjax;

    /**
     * Set the ajax flag to indicate whether
     * we are servicing an ajax request
     *
     * @param bool $isAjax Whether we are servicing an ajax request
     *
     * @return void
     */
    public function setAjax($isAjax)
    {
        $this->_isAjax = (boolean) $isAjax;
    }

    /**
     * Disables the rendering of the footer
     *
     * @return void
     */
    public function disable()
    {
        $this->_isEnabled = false;
    }

    /**
     * Renders the bookmark content
     *
     * @access public
     * @return string
     */
    public static function getBookmarkContent()
    {
        $output = '';
        $cfgBookmark = PMA_Bookmark_getParams();
        if ($cfgBookmark) {

            $tpl_bookmark_actions
                = '<span class="action collapse">' . __('Collapse') . '</span> '
                . '<span class="action expand">' . __('Expand') . '</span> '
                . '<span class="action requery">' . __('Requery') . '</span> '
                . '<span class="action edit_bookmark">' . __('Edit') . '</span> '
                .  '<span class="action delete_bookmark">' . __('Delete')
                . '</span> '
                . '<span class="text targetdb">' . __('Database')
                . ': <span>%s</span></span>';

            $bookmarks = PMA_Bookmark_getList();
            $output .= '<div class="message welcome"><span>';
            $count_bookmarks = count($bookmarks);
            if ($count_bookmarks > 0) {
                $output .= sprintf(
                    _ngettext(
                        'Showing %1$d bookmark (both private and shared)',
                        'Showing %1$d bookmarks (both private and shared)',
                        $count_bookmarks
                    ),
                    $count_bookmarks
                );
            } else {
                $output .= __('No bookmarks');
            }
            unset($count_bookmarks, $private_message, $shared_message);
            $output .= '</span></div>';
            foreach ($bookmarks as $val) {
                $output .= '<div class